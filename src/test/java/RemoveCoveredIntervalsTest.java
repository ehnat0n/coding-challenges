import org.testng.annotations.DataProvider;
import org.testng.annotations.Test;

import static org.testng.Assert.assertEquals;

public class RemoveCoveredIntervalsTest {

    @DataProvider(name = "testData")
    public Object[][] createDataObject() {
        return new Object[][]{
                {new int[][]{{1,4}, {3,6}, {2,8}}, 2}, //[example1]
                {new int[][]{{1,4}, {2,3}},        1}, //[example2]
                {new int[][]{{1,1}},               1}, //min entry, 0 length; technically invalid, considering [l, r)
                {new int[][]{{1,2}},               1}, //min entry, min non-zero length
                {new int[][]{{3,8}, {0,5}},        2}, //simple overlap, no removals
                {new int[][]{{3,8}, {4,5}, {0,6}}, 2}, //interval inside overlap
                {new int[][]{{1,2}, {3,5}, {0,4}}, 2}, //interval outside overlap
                {new int[][]{{0,5}, {1,4}, {2,3}}, 1}, //chain coverage - 1 resulting interval
                {new int[][]{{0,5}, {1,4}, {2,3}, {10,15}, {11,14}, {12,13}}, 2}, //two separate chain covered groups
                {new int[][]{{1,4}, {2,5}, {0,3}}, 3}, // triple overlap

                //matching interval left points
                {new int[][]{{1,4}, {1,2}, {3,4}}, 1}, //descending order for right points
                {new int[][]{{1,2}, {1,4}, {3,4}}, 1}, //ascending order for right points
                {new int[][]{{1,4}, {1,3}, {1,10}, {5,7}, {5,8}, {8,9}, {9,10}}, 1}, //second group of matching left points inside
                {new int[][]{{1,4}, {1,3}, {1,10}, {5,7}, {5,8}, {8,9}, {8,10}, {11,12}, {11,13}}, 2}, //second group of matching points outside
                {new int[][]{{30597,65607},{43229,96275},{29752,31708},{44604,76228},{3015,60857},{11529,29065},{50844,78587},{38493,73001},{18230,82462},{45196,53987},{12031,64727},{52986,56920},{9939,61707},{2585,24111},{31805,58978},{85366,91354},{43281,47816},{2757,30071},{49009,53647},{84861,86163},{92184,98383},{11058,95547},{31889,52432},{15795,66674},{4312,77842},{95742,98522},{58457,65528},{44783,46671},{47881,81726},{10242,45951},{48367,69001},{21310,51139},{3728,75122},{36646,62047},{25271,49659},{42630,58017},{78401,80426},{48381,94998},{43739,98372},{3666,29899},{34937,51527},{47697,84661},{26303,87350},{70597,76662},{28524,94146},{7982,61053},{66681,98930},{19015,61092},{22322,31988},{3851,71316},{6291,49587},{39229,47930},{24071,99124},{2663,74884},{78222,95621},{66626,83374},{5645,68102},{39909,66523},{3926,14432},{39250,41541},{43570,50462},{73734,81587},{25543,66013},{67969,81137},{48069,60525},{22556,36597},{59420,92598},{21672,85760},{59387,98750},{43450,73202},{7069,40734},{29918,84730},{44085,98780},{76,76657},{82293,99967},{2365,72118},{59548,83278},{94491,99048},{1435,8137},{39588,76608},{54845,89467},{62590,87485},{25864,74034},{17921,57514},{41210,47278},{3199,93140},{66641,79280},{11065,86891},{68885,80196},{1986,65574},{15792,49954},{3767,13820},{2846,29437},{26425,44148},{7086,52906},{4664,65393},{5526,9500},{57610,77791},{20599,53451},{28606,97306},{43221,75733},{7891,22815},{29102,89208},{67452,98395},{55578,72561},{3515,75206},{8691,27077},{25308,59588},{38718,61837},{5001,65936},{5389,27091},{59558,99527},{11360,72043},{28725,70432},{44992,59028},{54221,90331},{29472,64763},{31626,97662},{35065,90267},{24776,67147},{25731,38518},{46409,66379},{17445,47654},{18282,82488},{43384,52738},{63019,66138},{12236,21227},{5394,60176},{26789,53330},{6350,15455},{26073,98211},{6748,23983},{2089,90484},{21515,76509},{46426,80273},{48355,74734},{50737,87939},{3197,35201},{60599,93434},{3555,32990},{57535,83988},{16856,51048},{17157,67818},{43348,44196},{20826,76240},{46372,80873},{45980,66448},{28829,91889},{3000,27724},{42686,87715},{17671,85723},{14587,87938},{40998,85207},{59872,71699},{27020,79844},{46646,89309},{22791,70383},{33969,85710},{60340,66701},{29278,59628},{27648,74913},{69447,73589},{79649,94843},{11979,61670},{13600,51827},{19310,36236},{64624,87682},{6355,86436},{8287,87980},{25562,44968},{43470,48058},{26403,43581},{24401,63751},{25106,43487},{49961,86563},{8985,22849},{27717,72078},{26042,76705},{28724,81195},{6359,96113},{25736,28392},{5877,58380},{26300,86304},{41601,98270},{5115,36096},{44379,57385},{87449,97791},{26813,66541},{20227,75462},{22957,38090},{88540,97509},{67335,73573},{34565,99935},{8560,45667},{25808,72820},{42052,99013},{12420,40257},{59656,63390},{20257,75462},{69630,71570},{27037,84413},{58017,61533},{74226,96094},{23027,86384},{27420,48690},{41279,67171},{81126,85807},{68193,74810},{28484,37150},{1393,63450},{34019,40156},{2581,38712},{13419,57123},{73467,86122},{54115,81537},{34409,46326},{52029,71083},{20184,45519},{28149,97429},{3647,86141},{52060,74986},{15901,93998},{17097,82839},{41422,78472},{22761,95669},{47649,96396},{28001,90424},{12849,87192},{57914,80739},{20507,42259},{70451,91278},{36000,79920},{18427,31617},{18402,65847},{72249,98113},{25944,60910},{32510,39391},{73025,82436},{54623,68835},{35370,47648},{13441,68048},{28718,66420},{71584,99581},{71397,86344},{96959,98769},{91370,93968},{85661,89454},{20642,80275},{36523,87210},{21633,70612},{53429,62991},{11952,80181},{51057,73296},{41222,53766},{28305,73924},{15833,78987},{74922,97565},{32802,87829},{55354,83055},{16987,93021},{2806,69450},{13274,13296},{10310,91225},{32032,56515},{22388,66737},{30408,81356},{3247,27399},{47574,59862},{28660,32225},{64179,86441},{8266,58542},{35883,97328},{91464,94941},{29612,91996},{5006,80941},{16100,40093},{54518,67771},{40809,98141},{30243,50849},{35389,77150},{24028,27998},{44924,85538},{14183,55891},{66970,97169},{83260,90574},{59533,81153},{2808,77822},{34246,45723},{22362,46170},{15926,81725},{3772,26733},{50119,88355},{49895,71420},{29446,68067},{70432,79316},{35405,75799},{84318,96938},{45196,48980},{54523,67114},{282,17657}}, 7},
                {new int[][]{{15618,54256},{79107,80823},{19631,51837},{12199,34058},{24001,79388},{40646,42096},{24978,99547},{24861,25445},{18139,49644},{80122,99616},{48364,83991},{68438,78960},{6242,24583},{14185,75027},{51091,84506},{39508,80043},{72285,89702},{1135,16172},{34705,63164},{16391,82274},{44023,56064},{13264,87117},{83758,96578},{25787,64605},{47876,61185},{15978,24026},{21761,89989},{19685,32434},{13740,22684},{42619,93023},{39090,42689},{25006,78961},{16125,28048},{30491,48772},{61257,97190},{16404,41190},{4935,79498},{45748,60014},{35124,61553},{27025,94461},{47731,55404},{15264,31724},{16042,74030},{21594,80456},{30706,60297},{22441,48398},{50747,52094},{21723,38134},{22070,42147},{36510,51015},{50577,57634},{28594,38236},{6219,97546},{53577,74294},{43259,78162},{25358,80311},{59260,98107},{37606,65555},{29374,55106},{8432,87620},{77149,90227},{82217,84503},{24807,49838},{9846,41124},{29466,54653},{2829,47087},{15196,17965},{16141,32516},{60184,93920},{27038,75891},{64790,94702},{12240,34698},{43,72923},{15924,24486},{17287,56565},{64376,91586},{72113,76537},{92633,99045},{71616,87172},{16757,56548},{7450,70426},{82523,97211},{18089,58916},{31887,32520},{19663,46905},{43714,64656},{29843,32091},{32622,89461},{38417,58243},{13995,28318},{61237,67947},{13791,90951},{59476,65918},{61501,90305},{7064,76080},{13941,36544},{8599,89360},{23934,92850},{51986,61870},{48906,61369},{44372,58978},{18013,33223},{29813,34773},{16505,93898},{33459,90537},{14625,74059},{1807,77317},{62565,73560},{28157,33967},{11519,77581},{22959,43475},{34034,89114},{14283,58268},{34468,80160},{31491,45102},{48663,61793},{16715,24805},{24241,83192},{13642,26033},{58298,78095},{59627,79396},{26753,81690},{6157,66369},{312,9061},{20920,25927},{28116,73967},{30597,81536},{48062,96104},{53281,58242},{40492,97599},{41722,53851},{54800,66337},{3144,91586},{89642,93718},{62944,64214},{7571,69963},{78529,96183},{31509,94810},{24134,28990},{29730,87009},{2133,29740},{81159,84793},{12890,86297},{45858,88660},{2756,75686},{31079,82974},{25449,91556},{4537,27920},{15468,63942},{11352,79413},{57038,76079},{4090,32541},{57567,87605},{4396,43568},{1823,36183},{70355,87655},{12896,49659},{19574,44846},{16373,74811},{36175,42772},{47075,75631},{36105,40928},{53255,64774},{71719,80625},{30118,50690},{45020,65803},{8163,95182},{73803,75813},{52687,66487},{16208,28747},{8189,25248},{88371,90825},{39997,91474},{78475,80727},{67313,80837},{12997,30976},{10744,90070},{64323,74815},{52854,68503},{39123,53587},{31882,84388},{90621,96322},{63549,92916},{17700,27066},{5046,42621},{8415,46954},{5590,55490},{53276,73900},{25701,41684},{18298,96078},{14508,88532},{33549,58025},{46870,68366},{36351,68939},{13325,17715},{28006,94189},{26129,58071},{1159,90204},{43184,78056},{1650,60191},{22857,30856},{28303,52637},{62236,67001},{2030,64632},{52463,83799},{35475,73423},{77060,89346},{56920,83971},{9070,77651},{6473,22037},{24501,29567},{56122,97865},{28449,83669},{7383,41123},{26146,89708},{43744,46200},{17062,81015},{52415,55606},{2454,98375},{82615,88372},{34227,84137},{41726,85826},{21514,50166},{20657,69069},{16449,54284},{48184,99706},{32774,39296},{15188,43003},{87693,92804},{16814,96570},{17978,63140},{61492,89563},{93509,99379},{60630,85366},{37970,69082},{67409,98073},{63097,68663},{51881,57922},{1888,90872},{20010,26700},{19316,90559},{8954,15033},{15993,90126},{71286,78158},{13964,49519},{39929,69485},{49124,85402},{18219,41945},{61121,92467},{71212,94220},{30863,57455},{37284,54394},{36494,46557},{57978,79917},{63992,99397},{31955,91138},{8114,82742},{43014,43647},{37025,71731},{32478,65230},{31872,57567},{9399,27834},{49155,96538},{58093,60035},{10459,73796},{21261,47293},{13931,54756},{49284,55224},{66620,83085},{45955,84556},{7620,38808},{13585,75015},{43377,47933},{69203,90146},{16667,50339},{39147,56331},{84802,97994},{4143,81096},{41824,63698},{37762,38154},{52775,79228},{685,85385},{44637,86884},{79060,83809},{36773,60606},{14034,99688},{58053,99772},{52154,77852},{57877,92730},{6846,56486},{2876,13217},{43573,74949},{23950,44173},{36691,40834},{20392,73251},{66818,71635},{37949,96953},{9775,87691},{34933,49196},{58492,73120},{61903,83621},{569,71991},{27648,94812},{11537,39348},{33167,94819},{54663,81923},{32426,35279},{52824,82525},{48738,91592},{27892,88868},{40449,40713},{62961,79468},{57817,94911},{25390,46460},{1767,43425},{87077,99062},{8154,34010},{32032,83127},{26858,34190},{14235,22724},{88822,88925},{3986,68306},{63722,65062},{51259,82988},{30511,35623},{19766,51924},{7255,90479},{12467,29668},{28568,80600},{2246,65549},{79909,93257},{45461,86163},{27088,74248},{48612,51377},{55108,57874},{19978,85770},{41823,75664},{62481,92169},{52386,66085},{38472,85792},{61466,92424},{25516,37726},{5363,69527},{25385,62835},{46457,84141},{24970,94833},{59158,76913},{2626,21566},{59133,75967},{2493,26047},{46796,78097},{79474,83611},{6604,10747},{56955,84885},{36356,88450},{37642,96717},{95305,95437},{55896,64158},{2169,3230},{17121,64484},{22575,90955},{13915,66277},{43980,66866},{84244,92044},{8150,41149},{17679,84114},{6937,94457},{62309,70996},{65631,79651},{83702,91920},{61545,71519},{23412,81543},{30599,39517},{18816,80862},{76973,78501},{80906,90868},{13181,50160},{2614,8304},{39300,45504},{28610,37151},{15029,61198},{38769,79100},{28918,68716},{39572,96526},{11995,51410},{72964,85899},{6120,66100},{58344,96936},{82501,91088},{36568,91597},{1236,92711},{18610,39582},{47738,69747},{42804,77571},{6982,68298},{14657,67866},{41806,85865},{31037,33973},{63011,65402},{47593,85717},{3001,62998},{27090,93069},{62689,73539},{83477,97969},{9649,16580},{4345,90757},{78648,90543},{13618,71306},{70415,99040},{23266,47683},{77401,78700},{30213,46011},{73587,97968},{24967,43429},{14003,19610},{43706,80632},{36981,57605},{48554,72135},{50137,90175},{17414,80633},{36913,58593},{37054,87908},{63835,80757},{67527,98426},{2349,50379},{2974,81449},{32416,75897},{1250,42881},{50206,90553},{37012,80216},{23382,87726},{14101,78177},{3618,33193},{38871,50052},{57709,75901},{11326,77609},{11426,42532},{68592,83183},{69113,90324},{67924,84771},{21816,45492},{12156,77910},{48304,95921},{90838,98277},{24108,37275},{45904,89969},{48716,56316},{33539,78199},{94788,97194},{1823,97436},{52832,82156},{61964,82436},{14867,48078},{31071,75419},{46802,92669},{7482,64967},{7090,17539},{66699,87673},{5279,18234},{37094,69823},{18981,76316},{49060,74453},{67017,79510},{32447,54691},{38121,51592},{60045,79501},{64737,84987},{12791,92802},{16028,47260},{26369,36685},{78377,87140},{5869,55774},{67821,93023},{7413,57602},{20380,75635},{59565,62971},{16339,40026},{31173,94551},{9753,34128},{1520,12889},{26173,32985},{16272,28081},{56043,77506},{30400,62164},{16570,79845},{34403,76744},{15450,28658},{69354,90845},{11419,83299},{24865,54498},{38456,85225},{5156,21570},{29029,91060},{30343,88239},{35903,55329},{29457,70968},{73292,90196},{62978,90037},{8190,50373},{41880,67525},{21150,41254},{36004,48769},{65808,91018},{72242,76430},{16226,97557},{47618,66943},{11154,88568},{42577,63015},{12543,42516},{3048,9547},{46665,83345},{3961,82577},{7834,37698},{11637,79504},{2544,88793},{20919,93685},{2072,87439},{33743,87600},{7240,66792},{75592,87895},{8104,25570},{81663,84978},{11914,66822},{10273,37478},{6101,82132},{11673,82845},{18386,27118},{42355,97242},{17398,46169},{18883,58506},{37613,90458},{7491,31956},{30740,34828},{57769,58500},{9262,64005},{22408,59231},{33803,77653},{5722,90363},{31162,99548},{53696,59516},{47159,84726},{152,17553},{81334,87113},{64491,77868},{56256,56791},{45029,95395},{9769,74929},{382,77275},{30615,65530},{17881,84868},{11825,52679},{58333,67481},{6053,49727},{52202,72023},{54532,92834},{35620,45638},{10190,36912},{71279,87995},{26174,33378},{29055,93226},{26084,76435},{16366,40263},{61190,91282},{11261,99771},{18223,68366},{29164,44479},{2472,41864},{47077,65605},{2296,48040},{78832,81038},{10656,57166},{69511,99992},{25578,60537},{63849,85094},{72657,83367},{17186,37022},{66535,99494},{61125,61338},{46750,99768},{41855,74109},{85238,90748},{51090,70139},{64568,66638},{42894,64051},{25597,48331},{25277,93692},{21768,33855},{53481,80380},{8241,10857},{32250,56149},{26093,47873},{65081,80381},{50036,80868},{5467,76322},{42323,90220},{47947,49600},{35468,79406},{9850,70854},{22877,92346},{40362,61711},{9808,55397},{31471,41179},{14341,79344},{33877,44952},{69134,82802},{5781,47755},{62500,64928},{4564,10459},{11857,31689},{41798,91603},{18129,26183},{26252,94678},{31902,39250},{18707,53772},{32800,73634},{17345,86499},{30201,56301},{23497,87357},{36809,87204},{3080,87192},{20500,41441},{637,71303},{51886,72802},{15798,46658},{37826,38327},{7347,42533},{56037,97281},{45639,52028},{5710,22450},{70162,81571},{18322,90678},{1224,65911},{15723,58211},{22103,34837},{20047,25327},{78989,99437},{50050,92854},{38436,66255},{3061,22938},{38714,73111},{3743,42954},{8958,22731},{58476,96259},{63557,86837},{9430,58158},{9990,97816},{15543,95208},{44806,86825},{58608,62746},{20708,82340},{4528,49195},{69877,91181},{58443,79994},{8916,69718},{31252,65728},{21471,70779},{34948,53939},{52407,64723},{23203,50091},{22329,58547},{22551,92843},{63455,99938},{55291,96107},{72973,75899},{58246,73134},{27375,79256},{51416,95466},{67748,76048},{11271,31065},{31869,91875},{12203,60686},{31719,90033},{48700,89333},{58508,60903},{77796,85812},{21226,99493},{29777,58608},{26332,66332},{40910,64769},{17090,31364},{38753,47409},{37676,92928},{23569,98795},{64871,68557},{17103,42976},{15177,20210},{51829,60860},{77990,79132},{29206,61535},{52646,98795},{41085,65923},{61982,79250},{32093,97875},{32599,89293},{35376,85332},{35685,86535},{42710,44221},{75205,76581},{34698,58319},{57584,64541},{50210,86290},{51974,67711},{70102,99880},{14538,48637},{40617,87433},{64980,79671},{3974,73859},{10170,89639},{3050,51791},{10164,19656},{70911,99734},{52215,91296},{40729,85600},{133,38933},{38278,75793},{2249,7111},{34261,80076},{30722,38611},{8045,56752},{3321,14284},{21217,68430},{75597,95277},{32867,37764},{41747,87020},{53242,55656},{50932,80217},{39192,65468},{20664,25686},{65010,75833},{22232,80925},{45831,66854},{3567,16926},{6238,9715},{5451,72387},{24861,42820},{49015,83780},{34062,99130},{12731,13581},{1661,64144},{36847,58428},{64428,64706},{52232,56771},{23930,67524},{24179,78888},{65208,83642},{30526,61825},{43453,45468},{7783,14925},{2016,31767},{45382,57328},{19531,77469},{9934,94514},{48119,69329},{28899,80957},{67913,98403},{2259,86174},{19724,52034},{78306,87532},{11168,86039},{69154,73532},{35783,40913},{8380,63663},{50686,86015},{18172,64023},{4531,93979},{31513,56185},{3184,94263},{3848,80915},{577,31688},{62997,92213},{21733,96869},{13171,47240},{5613,80673},{44092,65908},{2270,64027},{2866,11947},{11905,87671},{11578,78936},{48595,80602},{62799,69134},{62810,66302},{66367,66834},{3557,91617},{20291,79532},{44076,57766},{42120,45211},{30720,95438},{59013,61791},{29735,31465},{15887,91323},{46391,86358},{83212,92710},{28395,49923},{3043,59291},{45467,57128},{61331,75869},{6239,8687},{63653,81616},{2800,20838},{28674,42042},{41962,63419},{703,4558},{46873,73406},{81400,87731},{46833,83041},{75080,80690},{10989,97726},{65810,70772},{3196,80743},{1969,98212},{30098,42181},{26798,48232},{21666,93626},{38413,42684},{20532,55230},{7869,86101},{2598,3098},{76377,86826},{77433,96012},{4703,46344},{38350,87548},{27989,80942},{67872,78971},{2281,86897},{15770,28147},{40440,95183},{20364,61610},{47595,65461},{11790,19355},{30265,95617},{65652,73163},{57018,72089},{34707,93884},{16636,17224},{51215,65206},{14726,26945},{11446,66409},{16757,72223},{9329,98649},{20738,79925},{13658,53444},{20566,48727},{70159,99314},{67769,72634},{36034,36069},{71582,92695},{471,93052},{42423,98615},{3018,40451},{16274,54480},{86410,92511},{91710,91983},{1886,34619},{32430,86389},{25479,63212},{25493,78654},{25330,54438},{423,16871},{45895,63241},{18726,37466},{30181,71881},{17111,41761},{5657,38470},{56680,87550},{10167,85477},{59363,60040},{34098,51289},{21068,24688},{3111,62149},{27591,74491},{23540,38432},{45407,49351},{61729,96296},{58151,59684},{2670,71632},{12739,24012},{48830,59704},{63623,64971},{7382,33373},{34931,51295},{6621,44191},{87224,90455},{7958,89995},{563,66362},{3353,75749},{17685,52927},{32930,52436},{46664,98269},{36501,50610},{13039,84916},{1266,32224},{27808,77240},{41437,43560},{6617,14618},{49644,69238},{59897,95061},{24740,88455},{66793,99391},{53761,72268},{11815,63265}}, 11}
        };
    }

    @Test(dataProvider = "testData")
    public void testSolution(int[][] intervals, int expected) {
        long startTime, endTime;

        startTime = System.nanoTime();
        int actual = new RemoveCoveredIntervals().removeCoveredIntervals(intervals);
        endTime = System.nanoTime();
        System.out.println("Solution run time: " + (endTime - startTime) / 1000000d + " milliseconds.");

        assertEquals(actual, expected);
    }
}
